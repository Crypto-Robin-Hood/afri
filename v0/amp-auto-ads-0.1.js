(self.AMP=self.AMP||[]).push({n:"amp-auto-ads",v:"1906282130140",f:(function(AMP,_){
var h,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},k;if("function"==typeof Object.setPrototypeOf)k=Object.setPrototypeOf;else{var m;a:{var ba={a:!0},p={};try{p.__proto__=ba;m=p.a;break a}catch(a){}m=!1}k=m?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var q=k;function ca(a){return a?{top:a.top,bottom:a.bottom,left:a.left,right:a.right}:a};function da(){var a,b;this.promise=new Promise(function(c,e){a=c;b=e});this.resolve=a;this.reject=b}function ea(a){return new Promise(function(b){b(a())})};function t(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var fa=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function u(a){var b=Object.create(null);if(!a)return b;for(var c;c=fa.exec(a);){var e=t(c[1],c[1]),d=c[2]?t(c[2],c[2]):"";b[e]=d}return b};var w="";
function x(){var a,b=a||self;if(b.AMP_MODE)var c=b.AMP_MODE;else{c=b;var e=self.AMP_CONFIG||{},d=!!e.test||!1,f=c.__karma__&&c.__karma__.config.amp.testOnIe,g=u(c.location.originalHash||c.location.hash);e=e.spt;var l=u(c.location.search);w||(w=c.AMP_CONFIG&&c.AMP_CONFIG.v?c.AMP_CONFIG.v:"011906282130140");c=b.AMP_MODE={localDev:!1,development:!("1"!=g.development&&!c.AMP_DEV_MODE),examiner:"2"==g.development,filter:g.filter,geoOverride:g["amp-geo"],userLocationOverride:g["amp-user-location"],minified:!0,
lite:void 0!=l.amp_lite,test:d,testIe:f,log:g.log,version:"1906282130140",rtvVersion:w,singlePassType:e}}return c};var ha=Object.prototype.toString;self.log=self.log||{user:null,dev:null,userForEmbed:null};var y=self.log;function z(){if(!y.user)throw Error("failed to call initLogConstructor");return y.user}function A(a,b){z().assert(a,b,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)};function B(a,b){a=a.__AMP_TOP||a;return C(a,b)}function D(a,b){var c=E(a);c=E(c);c=c.isSingleDoc()?c.win:c;return C(c,b)}function E(a){return a.nodeType?B((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function C(a,b){var c=a.services;c||(c=a.services={});var e=c;a=e[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
var F;function G(a){return a||{}};function H(a,b){var c=a.length-b.length;return 0<=c&&a.indexOf(b,c)==c}function I(a,b){return b.length>a.length?!1:0==a.lastIndexOf(b,0)};function J(a,b,c){a=a.createElement(b);for(var e in c)a.setAttribute(e,c[e]);return a}function ia(a,b){for(var c;a&&a!==c;a=a.parentElement)if(b(a))return a;return null}function ja(a,b){return a.closest?a.closest(b):ia(a,function(a){var c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector;return c?c.call(a,b):!1})}
function ka(a,b){if(void 0!==F)var c=F;else{try{var e=a.ownerDocument,d=e.createElement("div"),f=e.createElement("div");d.appendChild(f);c=d.querySelector(":scope div")===f}catch(g){c=!1}c=F=c}c?a=a.querySelectorAll(b.replace(/^|,/g,"$&:scope ")):(a.classList.add("i-amphtml-scoped"),b=b.replace(/^|,/g,"$&.i-amphtml-scoped "),b=a.querySelectorAll(b),a.classList.remove("i-amphtml-scoped"),a=b);return a}
function la(a){I(a.tagName,"AMP-");if(a.createdCallback)return Promise.resolve(a);if(!a.__AMP_UPG_PRM){var b=new da;a.__AMP_UPG_PRM=b.promise;a.__AMP_UPG_RES=b.resolve}return a.__AMP_UPG_PRM};function K(a){return D(a,"viewport")};var ma={type:!0};function L(a){if(!a.attributes)return{};if("[object Object]"!==ha.call(a.attributes)||Array.isArray(a.attributes))return z().warn("amp-auto-ads","attributes property not an object"),{};var b=a.attributes,c={},e;for(e in b)if(ma[e]||I(e,"data-")){var d=typeof b[e];"number"!=d&&"string"!=d&&"boolean"!=d?z().warn("amp-auto-ads","Attribute type not supported: "+d):c[e]=String(b[e])}else z().warn("amp-auto-ads","Attribute not whitlisted: "+e);return c};var na=["AMP-SIDEBAR","AMP-APP-BANNER"],oa={1:function(a,b){a.parentNode.insertBefore(b,a)},4:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},2:function(a,b){a.insertBefore(b,a.firstChild)},3:function(a,b){a.appendChild(b)}};function N(a,b,c,e,d,f,g){this.ampdoc=a;this.C=b;this.l=c;this.T=e;this.P=d;this.L=f;this.I=g;this.F=null;this.j=0}N.prototype.getAdElement=function(){return this.F};
N.prototype.getEstimatedPosition=function(){var a=this;return this.C.getElementLayoutBox(this.l).then(function(b){a:switch(a.T){case 1:case 2:b=b.top;break a;case 3:case 4:b=b.bottom;break a;default:throw Error("Unknown position");}return b})};
N.prototype.placeAd=function(a,b,c,e){var d=this;return this.getEstimatedPosition().then(function(f){return c.isTooNearAnAd(f).then(function(c){if(c)return d.j=3,d.j;d.F=pa(d,a,b.width);d.P(d.l,d.getAdElement());return qa(d,b,e).then(function(a){return la(d.getAdElement()).then(function(){return d.getAdElement().whenBuilt()}).then(function(){return d.C.attemptChangeSize(d.getAdElement(),a.height,a.width,a.margins)}).then(function(){d.j=2;return d.j},function(){d.j=1;return d.j})})})})};
function qa(a,b,c){var e=a.C.getViewport(),d=e.getWidth();if(c&&1200>=d){var f=e.getHeight(),g=ra(d,f),l=ca(a.I);return D(a.l,"resources").getElementLayoutBox(a.l).then(function(b){var c;(c=a.ampdoc.win.getComputedStyle(a.l))||(c=Object.create(null));c=c.direction;0!==b.left&&(l=l||{},"rtl"==c?l.right=b.left:l.left=-b.left)}).then(function(){return Promise.resolve({width:d,height:g,margins:l})})}return Promise.resolve({height:b.height||250,margins:a.I})}
function pa(a,b,c){b=Object.assign(G({layout:c?"fixed":"fixed-height",height:"0",width:c?c:"auto","class":"i-amphtml-layout-awaiting-size"}),b,a.L);return J(a.ampdoc.win.document,"amp-ad",b)}function sa(a,b){var c=b.placements;if(!c)return z().info("amp-auto-ads","No placements in config"),[];var e=[];c.forEach(function(b){ta(a,b,e)});return e}
function ta(a,b,c){var e=oa[b.pos];if(e){var d=b.anchor;if(d){var f=O(a.getRootNode(),d);if(f.length){var g=void 0;if(b.style){var l=parseInt(b.style.top_m,10),r=parseInt(b.style.bot_m,10);if(l||r)g={top:l||void 0,bottom:r||void 0}}f.forEach(function(d){if(ua(d,b.pos)){var f=L(b);c.push(new N(a,D(d,"resources"),d,b.pos,e,f,g))}})}else z().warn("amp-auto-ads","No anchor element found")}else z().warn("amp-auto-ads","No anchor in placement")}else z().warn("amp-auto-ads","No injector for position")}
function O(a,b){var c=b.selector;if(!c)return z().warn("amp-auto-ads","No selector in anchor"),[];c=[].slice.call(ka(a.documentElement||a,c));var e=b.min_c||0;0<e&&(c=c.filter(function(a){return a.textContent.length>=e}));"number"!=typeof b.index&&b.all||(c=(c=c[b.index||0])?[c]:[]);if(0==c.length)return[];if(b.sub){var d=[];c.forEach(function(a){d=d.concat(O(a,b.sub))});return d}return c}
function ua(a,b){var c=1==b||4==b?a.parentElement:a;if(!c)return z().warn("amp-auto-ads","Parentless anchor with BEFORE/AFTER position."),!1;var e=c;return!na.some(function(a){return ja(e,a)?(z().warn("amp-auto-ads","Placement inside blacklisted ancestor: "+a),!0):!1})}function ra(a,b){var c=100,e=Math.min(300,b),d=Math.round(a/1.2);return Math.min(Math.max(d,c),e)};function P(a,b){var c=4096,e,d=[],f=e&&null!=e.value&&""!==e.value?encodeURIComponent(e.name)+"="+encodeURIComponent(String(e.value)):null,g=c-a.length;f&&(g-=f.length+1);for(var l=Object.keys(b),r=0;r<l.length;r++){var V=l[r],v=b[V];if(null!=v&&""!==v){var n=encodeURIComponent(V)+"=",M=encodeURIComponent(String(v)),X=n.length+M.length+1;if(X>g){var Y=M.substr(0,g-n.length-1).replace(/%\w?$/,"");Y&&d.push(n+Y);f&&d.push(f);break}d.push(n+M);g-=X}}return d.length?a+"?"+d.join("&"):a};function Q(){this.N=100;this.A=this.D=0;this.w=Object.create(null)}Q.prototype.has=function(a){return!!this.w[a]};Q.prototype.get=function(a){var b=this.w[a];if(b)return b.access=++this.A,b.payload};
Q.prototype.put=function(a,b){this.has(a)||this.D++;this.w[a]={payload:b,access:this.A};if(!(this.D<=this.N)){if(y.dev)a=y.dev;else throw Error("failed to call initLogConstructor");a.warn("lru-cache","Trimming LRU cache");a=this.w;var c=this.A+1,e;for(e in a){var d=a[e].access;if(d<c){c=d;var f=e}}void 0!==f&&(delete a[f],this.D--)}};G({c:!0,v:!0,a:!0,ad:!0,action:!0});var R,S;
function va(a){var b;R||(R=self.document.createElement("a"),S=self.UrlCache||(self.UrlCache=new Q));var c=b?null:S,e=R;if(c&&c.has(a))a=c.get(a);else{e.href=a;e.protocol||(e.href=e.href);var d={href:e.href,protocol:e.protocol,host:e.host,hostname:e.hostname,port:"0"==e.port?"":e.port,pathname:e.pathname,search:e.search,hash:e.hash,origin:null};"/"!==d.pathname[0]&&(d.pathname="/"+d.pathname);if("http:"==d.protocol&&80==d.port||"https:"==d.protocol&&443==d.port)d.port="",d.host=d.hostname;d.origin=
e.origin&&"null"!=e.origin?e.origin:"data:"!=d.protocol&&d.host?d.protocol+"//"+d.host:d.href;e=x().test&&Object.freeze?Object.freeze(d):d;c&&c.put(a,e);a=e}return a};function wa(a,b){return(x().test||x().localDev)&&"_ping_"==a?new xa(b):"adsense"==a?new ya(b):"doubleclick"==a?new za(b):null}function xa(a){this.h=a}h=xa.prototype;h.isEnabled=function(){return!0};h.isResponsiveEnabled=function(){return!0};h.getConfigUrl=function(){return P("//lh3.googleusercontent.com/pSECrJ82R7-AqeBCOEPGPM9iG9OEIQ_QXcbubWIOdkY=w400-h300-no-n",{})};h.getAttributes=function(){return G({type:"_ping_"})};
h.getDefaultAdConstraints=function(){var a=K(this.h).getSize().height;return{initialMinSpacing:a,subsequentMinSpacing:[{adCount:3,spacing:2*a},{adCount:6,spacing:3*a}],maxAdCount:8}};h.getSizing=function(){return{}};function ya(a){this.h=a}h=ya.prototype;h.isEnabled=function(){return!0};h.isResponsiveEnabled=function(){return!0};
h.getConfigUrl=function(){var a=D(this.h,"documentInfo").get(),b=va(a.canonicalUrl).hostname;return P("//pagead2.googlesyndication.com/getconfig/ama",{client:this.h.getAttribute("data-ad-client"),plah:b,ama_t:"amp",url:a.canonicalUrl})};h.getAttributes=function(){var a=G({type:"adsense","data-ad-client":this.h.getAttribute("data-ad-client")}),b=this.h.getAttribute("data-ad-host");b&&(a["data-ad-host"]=b);return a};
h.getDefaultAdConstraints=function(){var a=K(this.h).getSize().height;return{initialMinSpacing:a,subsequentMinSpacing:[{adCount:3,spacing:2*a},{adCount:6,spacing:3*a}],maxAdCount:8}};h.getSizing=function(){return{}};function za(a){this.h=a}h=za.prototype;h.isEnabled=function(){return!0};h.isResponsiveEnabled=function(){return!1};
h.getConfigUrl=function(){var a=D(this.h,"documentInfo").get(),b=va(a.canonicalUrl).hostname;return P("//pagead2.googlesyndication.com/getconfig/ama",{client:this.h.getAttribute("data-ad-legacy-client"),plah:b,ama_t:"amp",url:a.canonicalUrl})};h.getAttributes=function(){return G({type:"doubleclick","data-slot":this.h.getAttribute("data-slot"),json:this.h.getAttribute("data-json")})};
h.getDefaultAdConstraints=function(){var a=K(this.h).getSize().height;return{initialMinSpacing:a,subsequentMinSpacing:[{adCount:3,spacing:2*a},{adCount:6,spacing:3*a}],maxAdCount:8}};h.getSizing=function(){var a=this.h.getAttribute("data-experiment");try{var b=JSON.parse(a)}catch(e){b=null}var c=b;return c?{height:c.height?Number(c.height):250,width:c.width?Number(c.width):void 0}:{}};function Aa(a,b,c,e,d){d=void 0===d?!1:d;this.M=a.slice(0);this.B=b;this.U=c;this.m=e;this.G=0;this.R=d}Aa.prototype.run=function(){var a=this;return this.m.isMaxAdCountReached()?ea(function(){return Ba(a)}):Ca(this).then(function(b){return b?a.run():Ba(a)})};function Ba(a){return{adsPlaced:a.G,totalAdsOnPage:a.m.getAdCount()}}
function Ca(a){var b=a.M.shift();return b?b.placeAd(a.B,a.U,a.m,a.R).then(function(c){return 2==c?(a.m.addAd(b.getAdElement()),a.G++,!0):Ca(a)}):(z().info("amp-auto-ads","unable to fulfill ad strategy"),Promise.resolve(!1))};function T(a,b){this.o=a;this.O=b.initialMinSpacing;this.K=b.subsequentMinSpacing.slice(0).sort(function(a,b){return a.adCount-b.adCount});this.S=b.maxAdCount;this.J=Da(this)}T.prototype.addAd=function(a){this.o.push(a);this.J=Da(this)};T.prototype.getAdCount=function(){return this.o.length};T.prototype.isMaxAdCountReached=function(){return this.getAdCount()>=this.S};T.prototype.isTooNearAnAd=function(a){return Ea(this,a,0)};
function Ea(a,b,c){return c>=a.o.length?Promise.resolve(!1):Fa(b,a.o[c]).then(function(e){return e<a.J?!0:Ea(a,b,c+1)})}function Fa(a,b){return D(b,"resources").getElementLayoutBox(b).then(function(b){return a>=b.top&&a<=b.bottom?0:Math.min(Math.abs(a-b.top),Math.abs(a-b.bottom))})}function Da(a){for(var b=a.getAdCount(),c=a.O,e=0;e<a.K.length;e++){var d=a.K[e];d.adCount<=b&&(c=d.spacing)}return c}
function Ga(a){return[].slice.call(a.getRootNode().querySelectorAll("AMP-AD")).filter(function(a){return a.parentElement&&"AMP-STICKY-AD"==a.parentElement.tagName?!1:!0})}
function Ha(a,b){b=b.adConstraints;if(!b)return null;var c=K(a).getHeight(),e=Ia(b.initialMinSpacing,c);if(null==e)return z().warn("amp-auto-ads","Invalid initial min spacing"),null;var d=(b.subsequentMinSpacing||[]).map(function(a){var b=a.adCount;if(null==b)return z().warn("amp-auto-ads","No subsequentMinSpacing adCount specified"),null;a=Ia(a.spacing,c);return null==a?(z().warn("amp-auto-ads","Invalid subsequent min spacing"),null):{adCount:b,spacing:a}});return-1!=d.indexOf(null)?null:null==b.maxAdCount?
(z().warn("amp-auto-ads","No maxAdCount specified"),null):{initialMinSpacing:e,subsequentMinSpacing:d,maxAdCount:b.maxAdCount}}function Ia(a,b){if(!a)return null;var c=parseFloat(a);return isNaN(c)||0>c?null:H(a,"px")?c:H(a,"vp")?c*b:null};function Ja(a,b,c){this.ampdoc=a;this.B=b;this.H=c}
Ja.prototype.run=function(){var a=(this.H.optInStatus||[]).includes(2),b=(this.H.optInStatus||[]).includes(4);if(this.ampdoc.getRootNode().querySelector("AMP-STICKY-AD"))return b?z().warn("amp-auto-ads","Auto ads may not work because of already existing <amp-sticky-ad>."):z().warn("amp-auto-ads","Auto Ads is unable to create an anchor ad because of already existing <amp-sticky-ad>."),Promise.resolve(!1);if(!a&&!b)return Promise.resolve(!1);B(this.ampdoc.win,"extensions").installExtensionForDoc(this.ampdoc,
"amp-sticky-ad","1.0");var c=K(this.ampdoc).getWidth(),e=Object.assign({},this.B,G({width:String(c),height:"100"}));c=this.ampdoc.win.document;e=J(c,"amp-ad",e);c=J(c,"amp-sticky-ad",G({layout:"nodisplay","data-no-fill":String(b&&!a)}));c.appendChild(e);e=this.ampdoc.getBody();e.insertBefore(c,e.firstChild);return Promise.resolve(!0)};function Ka(a){var b="amp-auto-ads";if(a.__AMP__EXPERIMENT_TOGGLES)var c=a.__AMP__EXPERIMENT_TOGGLES;else{a.__AMP__EXPERIMENT_TOGGLES=Object.create(null);c=a.__AMP__EXPERIMENT_TOGGLES;if(a.AMP_CONFIG)for(var e in a.AMP_CONFIG){var d=a.AMP_CONFIG[e];"number"===typeof d&&0<=d&&1>=d&&(c[e]=Math.random()<d)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length&&(e=a.AMP_CONFIG["allow-doc-opt-in"],d=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]'))){d=
d.getAttribute("content").split(",");for(var f=0;f<d.length;f++)-1!=e.indexOf(d[f])&&(c[d[f]]=!0)}Object.assign(c,La(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length)for(e=a.AMP_CONFIG["allow-url-opt-in"],a=u(a.location.originalHash||a.location.hash),d=0;d<e.length;d++)f=a["e-"+e[d]],"1"==f&&(c[e[d]]=!0),"0"==f&&(c[e[d]]=!1)}var g=c;return!!g[b]}
function La(a){a:{try{var b=a.document.cookie}catch(l){b=""}if(a=b)for(a=a.split(";"),b=0;b<a.length;b++){var c=a[b].trim(),e=c.indexOf("="),d;if(d=-1!=e)d=c.substring(0,e).trim(),d="AMP_EXP"==t(d,void 0);if(d){a=c.substring(e+1).trim();a=t(a,a);break a}}a=null}var f=a,g=f?f.split(/\s*,\s*/g):[];a=Object.create(null);for(b=0;b<g.length;b++)0!=g[b].length&&("-"==g[b][0]?a[g[b].substr(1)]=!1:a[g[b]]=!0);return a};function U(){return AMP.BaseElement.apply(this,arguments)||this}var W=AMP.BaseElement;U.prototype=aa(W.prototype);U.prototype.constructor=U;if(q)q(U,W);else for(var Z in W)if("prototype"!=Z)if(Object.defineProperties){var Ma=Object.getOwnPropertyDescriptor(W,Z);Ma&&Object.defineProperty(U,Z,Ma)}else U[Z]=W[Z];U.V=W.prototype;
U.prototype.buildCallback=function(){var a=this;A(Ka(this.win),"Experiment is off");var b=this.element.getAttribute("type");A(b,"Missing type attribute");var c=wa(b,this.element);A(c,"No AdNetworkConfig for type: "+b);if(c.isEnabled(this.win)){var e=this.getAmpDoc();B(this.win,"extensions").installExtensionForDoc(e,"amp-ad");var d=D(this.getAmpDoc(),"viewer"),f=d.whenFirstVisible();f.then(function(){return Na(a,c.getConfigUrl())}).then(function(b){if(b){var d=b.noConfigReason;if(d)a.user().warn("amp-auto-ads",
d);else{var f=sa(e,b),g=Object.assign(c.getAttributes(),L(b)),v=c.getSizing(),n=Ha(e,b)||c.getDefaultAdConstraints();n=new T(Ga(e),n);(new Aa(f,g,v,n,c.isResponsiveEnabled())).run();(new Ja(e,g,b)).run()}}})}};U.prototype.isLayoutSupported=function(){return!0};
function Na(a,b){var c={mode:"cors",method:"GET",credentials:"omit"};return B(a.win,"xhr").fetchJson(b,c).then(function(a){return a.json()}).catch(function(b){a.user().error("amp-auto-ads","amp-auto-ads config xhr failed: "+b);return null})}(function(a){a.registerElement("amp-auto-ads",U)})(self.AMP);
})});

//# sourceMappingURL=amp-auto-ads-0.1.js.map
